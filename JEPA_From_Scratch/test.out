Defaulting to user installation because normal site-packages is not writeable
Requirement already satisfied: torch>=2.0.0 in /home/abelde/.local/lib/python3.11/site-packages (from -r requirements.txt (line 1)) (2.5.1)
Requirement already satisfied: torchvision>=0.15.0 in /home/abelde/.local/lib/python3.11/site-packages (from -r requirements.txt (line 2)) (0.20.1)
Requirement already satisfied: numpy>=1.21.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from -r requirements.txt (line 3)) (1.26.4)
Requirement already satisfied: scipy>=1.7.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from -r requirements.txt (line 4)) (1.11.4)
Requirement already satisfied: Pillow>=8.2.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from -r requirements.txt (line 5)) (10.2.0)
Requirement already satisfied: PyYAML>=6.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from -r requirements.txt (line 6)) (6.0.1)
Requirement already satisfied: tqdm>=4.61.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from -r requirements.txt (line 7)) (4.65.0)
Requirement already satisfied: scikit-learn>=0.24.2 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from -r requirements.txt (line 8)) (1.2.2)
Requirement already satisfied: matplotlib>=3.4.2 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from -r requirements.txt (line 9)) (3.8.0)
Requirement already satisfied: tensorboard>=2.5.0 in /home/abelde/.local/lib/python3.11/site-packages (from -r requirements.txt (line 10)) (2.18.0)
Requirement already satisfied: h5py>=3.2.1 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from -r requirements.txt (line 11)) (3.9.0)
Requirement already satisfied: requests>=2.25.1 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from -r requirements.txt (line 12)) (2.31.0)
Requirement already satisfied: filelock in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (3.13.1)
Requirement already satisfied: typing-extensions>=4.8.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (4.9.0)
Requirement already satisfied: networkx in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (3.1)
Requirement already satisfied: jinja2 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (3.1.3)
Requirement already satisfied: fsspec in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (2023.10.0)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.4.127 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (12.4.127)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.4.127 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (12.4.127)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.4.127 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (12.4.127)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.4.5.8 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (12.4.5.8)
Requirement already satisfied: nvidia-cufft-cu12==11.2.1.3 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (11.2.1.3)
Requirement already satisfied: nvidia-curand-cu12==10.3.5.147 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (10.3.5.147)
Requirement already satisfied: nvidia-cusolver-cu12==11.6.1.9 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (11.6.1.9)
Requirement already satisfied: nvidia-cusparse-cu12==12.3.1.170 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (12.3.1.170)
Requirement already satisfied: nvidia-nccl-cu12==2.21.5 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (2.21.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.4.127 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (12.4.127)
Requirement already satisfied: nvidia-nvjitlink-cu12==12.4.127 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (12.4.127)
Requirement already satisfied: triton==3.1.0 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (3.1.0)
Requirement already satisfied: sympy==1.13.1 in /home/abelde/.local/lib/python3.11/site-packages (from torch>=2.0.0->-r requirements.txt (line 1)) (1.13.1)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from sympy==1.13.1->torch>=2.0.0->-r requirements.txt (line 1)) (1.3.0)
Requirement already satisfied: joblib>=1.1.1 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from scikit-learn>=0.24.2->-r requirements.txt (line 8)) (1.2.0)
Requirement already satisfied: threadpoolctl>=2.0.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from scikit-learn>=0.24.2->-r requirements.txt (line 8)) (2.2.0)
Requirement already satisfied: contourpy>=1.0.1 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from matplotlib>=3.4.2->-r requirements.txt (line 9)) (1.2.0)
Requirement already satisfied: cycler>=0.10 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from matplotlib>=3.4.2->-r requirements.txt (line 9)) (0.11.0)
Requirement already satisfied: fonttools>=4.22.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from matplotlib>=3.4.2->-r requirements.txt (line 9)) (4.25.0)
Requirement already satisfied: kiwisolver>=1.0.1 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from matplotlib>=3.4.2->-r requirements.txt (line 9)) (1.4.4)
Requirement already satisfied: packaging>=20.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from matplotlib>=3.4.2->-r requirements.txt (line 9)) (23.1)
Requirement already satisfied: pyparsing>=2.3.1 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from matplotlib>=3.4.2->-r requirements.txt (line 9)) (3.0.9)
Requirement already satisfied: python-dateutil>=2.7 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from matplotlib>=3.4.2->-r requirements.txt (line 9)) (2.8.2)
Requirement already satisfied: absl-py>=0.4 in /home/abelde/.local/lib/python3.11/site-packages (from tensorboard>=2.5.0->-r requirements.txt (line 10)) (2.1.0)
Requirement already satisfied: grpcio>=1.48.2 in /home/abelde/.local/lib/python3.11/site-packages (from tensorboard>=2.5.0->-r requirements.txt (line 10)) (1.67.1)
Requirement already satisfied: markdown>=2.6.8 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from tensorboard>=2.5.0->-r requirements.txt (line 10)) (3.4.1)
Requirement already satisfied: protobuf!=4.24.0,>=3.19.6 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from tensorboard>=2.5.0->-r requirements.txt (line 10)) (3.20.3)
Requirement already satisfied: setuptools>=41.0.0 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from tensorboard>=2.5.0->-r requirements.txt (line 10)) (68.2.2)
Requirement already satisfied: six>1.9 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from tensorboard>=2.5.0->-r requirements.txt (line 10)) (1.16.0)
Requirement already satisfied: tensorboard-data-server<0.8.0,>=0.7.0 in /home/abelde/.local/lib/python3.11/site-packages (from tensorboard>=2.5.0->-r requirements.txt (line 10)) (0.7.2)
Requirement already satisfied: werkzeug>=1.0.1 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from tensorboard>=2.5.0->-r requirements.txt (line 10)) (2.2.3)
Requirement already satisfied: charset-normalizer<4,>=2 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from requests>=2.25.1->-r requirements.txt (line 12)) (2.0.4)
Requirement already satisfied: idna<4,>=2.5 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from requests>=2.25.1->-r requirements.txt (line 12)) (3.4)
Requirement already satisfied: urllib3<3,>=1.21.1 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from requests>=2.25.1->-r requirements.txt (line 12)) (2.0.7)
Requirement already satisfied: certifi>=2017.4.17 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from requests>=2.25.1->-r requirements.txt (line 12)) (2024.2.2)
Requirement already satisfied: MarkupSafe>=2.1.1 in /apps/cent7/anaconda/2024.02/lib/python3.11/site-packages (from werkzeug>=1.0.1->tensorboard>=2.5.0->-r requirements.txt (line 10)) (2.1.3)
INFO:root:called-params configs/in1k_vith14_ep300.yaml
INFO:root:loaded params...
{   'data': {   'batch_size': 128,
                'color_jitter_strength': 0.0,
                'crop_scale': [0.3, 1.0],
                'crop_size': 224,
                'image_folder': 'imagenet_full_size/061417/',
                'num_workers': 10,
                'pin_mem': True,
                'root_path': '/home/abelde/DL_Research/ijepa/src/datasets/',
                'use_color_distortion': False,
                'use_gaussian_blur': False,
                'use_horizontal_flip': False},
    'logging': {   'folder': '/home/abelde/DL_Research/ijepa/Logging',
                   'write_tag': 'jepa'},
    'mask': {   'allow_overlap': False,
                'aspect_ratio': [0.75, 1.5],
                'enc_mask_scale': [0.85, 1.0],
                'min_keep': 10,
                'num_enc_masks': 1,
                'num_pred_masks': 4,
                'patch_size': 14,
                'pred_mask_scale': [0.15, 0.2]},
    'meta': {   'copy_data': False,
                'load_checkpoint': True,
                'model_name': 'vit_huge',
                'pred_depth': 12,
                'pred_emb_dim': 384,
                'read_checkpoint': 'IN1K-vit.h.14-300e.pth.tar',
                'use_bfloat16': True},
    'optimization': {   'ema': [0.996, 1.0],
                        'epochs': 300,
                        'final_lr': 1e-06,
                        'final_weight_decay': 0.4,
                        'ipe_scale': 1.0,
                        'lr': 0.001,
                        'start_lr': 0.0002,
                        'warmup': 40,
                        'weight_decay': 0.04}}
INFO:root:Running... (rank: 0/1)
INFO:root:Initialized (rank/world-size) 0/1
INFO:root:VisionTransformer(
  (patch_embed): PatchEmbed(
    (proj): Conv2d(3, 1280, kernel_size=(14, 14), stride=(14, 14))
  )
  (blocks): ModuleList(
    (0-31): 32 x Block(
      (norm1): LayerNorm((1280,), eps=1e-06, elementwise_affine=True)
      (attn): Attention(
        (qkv): Linear(in_features=1280, out_features=3840, bias=True)
        (attn_drop): Dropout(p=0.0, inplace=False)
        (proj): Linear(in_features=1280, out_features=1280, bias=True)
        (proj_drop): Dropout(p=0.0, inplace=False)
      )
      (drop_path): Identity()
      (norm2): LayerNorm((1280,), eps=1e-06, elementwise_affine=True)
      (mlp): MLP(
        (fc1): Linear(in_features=1280, out_features=5120, bias=True)
        (act): GELU(approximate='none')
        (fc2): Linear(in_features=5120, out_features=1280, bias=True)
        (drop): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (norm): LayerNorm((1280,), eps=1e-06, elementwise_affine=True)
)
INFO:root:making imagenet data transforms
INFO:root:data-path /home/abelde/DL_Research/ijepa/src/datasets/imagenet_full_size/061417/train/
INFO:root:Initialized ImageNet
INFO:root:ImageNet dataset created
INFO:root:ImageNet unsupervised data loader created
INFO:root:Using AdamW
INFO:root:Encountered exception when loading checkpoint [Errno 2] No such file or directory: '/home/abelde/DL_Research/ijepa/Logging/IN1K-vit.h.14-300e.pth.tar'
INFO:root:Epoch 1
